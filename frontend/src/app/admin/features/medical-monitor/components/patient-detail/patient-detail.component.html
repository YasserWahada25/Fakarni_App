<div class="patient-detail-container" *ngIf="patient; else loading">

    <button mat-button (click)="goBack()" class="back-btn">
        <mat-icon>arrow_back</mat-icon> Retour à la liste
    </button>

    <div class="patient-header mat-elevation-z1">
        <div class="profile-info">
            <h1>{{patient.firstName}} {{patient.lastName}}</h1>
            <span class="role-badge">{{patient.role}}</span>
        </div>
        <div class="meta-info">
            <p><strong>Date de naissance:</strong> {{patient.dateOfBirth | date:'dd/MM/yyyy'}}</p>
            <p><strong>Dernière consultation:</strong> {{patient.lastConsultation | date:'dd/MM/yyyy'}}</p>
            <p><strong>Email:</strong> {{patient.email}}</p>
        </div>
    </div>

    <div class="dashboard-grid">
        <!-- Chart Section -->
        <mat-card class="chart-card">
            <mat-card-header>
                <mat-card-title>Progression de Santé</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <div class="chart-container">
                    <canvas #healthChart></canvas>
                </div>
            </mat-card-content>
        </mat-card>

        <!-- Reports Section -->
        <mat-card class="reports-card">
            <mat-card-header>
                <mat-card-title>Historique des Rapports Médicaux</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <mat-list>
                    <mat-list-item *ngFor="let report of reports">
                        <mat-icon matListItemIcon>description</mat-icon>
                        <div matListItemTitle>{{report.type}} - {{report.date | date:'dd/MM/yyyy'}}</div>
                        <div matListItemLine>{{report.status}}</div>
                    </mat-list-item>
                    <div *ngIf="reports.length === 0" class="no-data">Aucun rapport disponible.</div>
                </mat-list>
            </mat-card-content>
        </mat-card>
    </div>

</div>

<ng-template #loading>
    <div class="loading-spinner">
        Chargement...
    </div>
</ng-template>