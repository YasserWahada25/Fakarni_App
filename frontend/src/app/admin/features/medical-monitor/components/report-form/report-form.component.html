<h2 mat-dialog-title>{{ isEditMode ? 'Modifier le Rapport' : 'Nouveau Rapport' }}</h2>
<mat-dialog-content>
    <form [formGroup]="reportForm" class="form-grid">

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Patient</mat-label>
            <mat-select formControlName="patientId">
                <mat-option *ngFor="let patient of patients" [value]="patient.id">
                    {{patient.firstName}} {{patient.lastName}}
                </mat-option>
            </mat-select>
            <mat-error *ngIf="reportForm.get('patientId')?.hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
            <mat-label>Type de Rapport</mat-label>
            <mat-select formControlName="type">
                <mat-option value="Analyse Médicale">Analyse Médicale</mat-option>
                <mat-option value="Détection Maladie">Détection Maladie</mat-option>
                <mat-option value="Suivi Cognitif">Suivi Cognitif</mat-option>
                <mat-option value="Autre">Autre</mat-option>
            </mat-select>
            <mat-error *ngIf="reportForm.get('type')?.hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
            <mat-label>Date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="date">
            <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
            <mat-error *ngIf="reportForm.get('date')?.hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
            <mat-label>Statut</mat-label>
            <mat-select formControlName="status">
                <mat-option value="En attente">En attente</mat-option>
                <mat-option value="Terminé">Terminé</mat-option>
                <mat-option value="Critique">Critique</mat-option>
            </mat-select>
            <mat-error *ngIf="reportForm.get('status')?.hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline">
            <mat-label>Médecin Responsable</mat-label>
            <input matInput formControlName="doctorName">
        </mat-form-field>

        <mat-form-field appearance="outline" class="full-width">
            <mat-label>Contenu du Rapport</mat-label>
            <textarea matInput formControlName="content" rows="6"></textarea>
            <mat-error *ngIf="reportForm.get('content')?.hasError('required')">Le contenu est requis</mat-error>
        </mat-form-field>

    </form>
</mat-dialog-content>
<mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()">Annuler</button>
    <button mat-raised-button color="primary" [disabled]="reportForm.invalid" (click)="onSubmit()">
        {{ isEditMode ? 'Enregistrer' : 'Créer' }}
    </button>
</mat-dialog-actions>