<div class="zone-management-container">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="page-header">
    <div>
      <h2 class="page-title">ğŸ“ Geographic Zones</h2>
      <p class="page-subtitle">Read-only â€” manage zones from the Live Tracking map</p>
    </div>
    <button mat-raised-button color="primary" (click)="loadZones()" [disabled]="isLoading">
      <mat-icon>refresh</mat-icon> Refresh
    </button>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• STAT CARDS â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="stats-row">
    <div class="stat-card total">
      <span class="stat-icon">ğŸ—ºï¸</span>
      <div class="stat-text">
        <span class="stat-value">{{ totalZones }}</span>
        <span class="stat-label">Total Zones</span>
      </div>
    </div>
    <div class="stat-card safe">
      <span class="stat-icon">âœ…</span>
      <div class="stat-text">
        <span class="stat-value">{{ safeZones }}</span>
        <span class="stat-label">Safe Zones</span>
      </div>
    </div>
    <div class="stat-card danger">
      <span class="stat-icon">âš ï¸</span>
      <div class="stat-text">
        <span class="stat-value">{{ dangerZones }}</span>
        <span class="stat-label">Danger Zones</span>
      </div>
    </div>
  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• TABLE CARD â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="table-card">

    <!-- Card header -->
    <div class="table-card-header">
      <span class="table-card-title">Zone List</span>
      <span class="header-spacer"></span>
      <!-- Search â€” plain input, no mat-form-field dependency -->
      <div class="search-box">
        <span class="search-icon">ğŸ”</span>
        <input
          class="search-input"
          type="text"
          placeholder="Search by name, patient ID, typeâ€¦"
          (input)="applyFilter($event)" />
      </div>
    </div>

    <!-- Loading -->
    <div class="loading-state" *ngIf="isLoading">
      <div class="spinner"></div>
      <span>Loading zonesâ€¦</span>
    </div>

    <!-- Empty -->
    <div class="empty-state" *ngIf="!isLoading && zones.length === 0">
      <span class="empty-icon">ğŸ“­</span>
      <p>No zones found.</p>
      <small>Add zones from the Live Tracking page.</small>
    </div>

    <!-- No search results -->
    <div class="empty-state" *ngIf="!isLoading && zones.length > 0 && filteredZones.length === 0">
      <span class="empty-icon">ğŸ”</span>
      <p>No results for "<b>{{ searchTerm }}</b>"</p>
    </div>

    <!-- Plain HTML Table â€” no MatTableModule needed -->
    <div class="table-wrapper" *ngIf="!isLoading && filteredZones.length > 0">
      <table class="zones-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Zone Name</th>
            <th>Patient ID</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>Radius</th>
            <th>Type</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let z of filteredZones" class="zone-row">
            <td><span class="id-chip">{{ z.id }}</span></td>
            <td><strong>{{ z.nomZone }}</strong></td>
            <td><span class="patient-chip">ğŸ‘¤ {{ z.patientId }}</span></td>
            <td class="coord-cell">{{ formatCoord(z.centreLat) }}</td>
            <td class="coord-cell">{{ formatCoord(z.centreLon) }}</td>
            <td><span class="radius-badge">â­• {{ z.rayon }}m</span></td>
            <td>
              <span class="type-badge"
                    [class.safe-badge]="z.type === 'SAFE'"
                    [class.danger-badge]="z.type === 'DANGER'">
                {{ z.type }}
              </span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• INFO BANNER â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div class="info-banner">
    <span>â„¹ï¸</span>
    <span>
      To <b>add</b>, <b>edit</b>, or <b>delete</b> zones, go to the
      <b>Live Tracking</b> page.
    </span>
  </div>

</div>