<div class="mri-container">
    <div class="analysis-header">
        <h1><i class="fa-solid fa-brain"></i> AI Disease Detection</h1>
        <p>Upload MRI scans for automated analysis and anomaly detection.</p>
    </div>

    <div class="workspace">
        <!-- Image Viewer -->
        <div class="image-viewer-card">
            <div class="viewer-controls">
                <button (click)="zoomIn()" title="Zoom In"><i class="fa-solid fa-magnifying-glass-plus"></i></button>
                <button (click)="zoomOut()" title="Zoom Out"><i class="fa-solid fa-magnifying-glass-minus"></i></button>
                <button (click)="zoom=1; panX=0; panY=0" title="Reset"><i class="fa-solid fa-compress"></i></button>
            </div>

            <div class="viewport" (mousedown)="startDrag($event)" (mousemove)="drag($event)" (mouseup)="endDrag()"
                (mouseleave)="endDrag()">
                <div class="image-wrapper"
                    [style.transform]="'translate(' + panX + 'px, ' + panY + 'px) scale(' + zoom + ')'">
                    <img src="" alt="MRI Scan" draggable="false">

                    <!-- Mock AI Overlay (Visible only after analysis) -->
                    <div *ngIf="analysisComplete" class="ai-overlay">
                        <div class="annotation" style="top: 40%; left: 45%; width: 50px; height: 50px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Analysis Panel -->
        <div class="report-card">
            <div class="card-header">
                <h3>Analysis Report</h3>
                <span class="status-badge" [class.analyzing]="isAnalyzing" [class.complete]="analysisComplete">
                    {{ isAnalyzing ? 'Processing...' : (analysisComplete ? 'Completed' : 'Ready') }}
                </span>
            </div>

            <div class="card-body">
                <div *ngIf="!isAnalyzing && !analysisComplete" class="empty-state">
                    <i class="fa-solid fa-microscope"></i>
                    <p>No analysis performed yet.</p>
                    <button class="btn-primary" (click)="runAIAnalysis()">
                        Start AI Analysis
                    </button>
                </div>

                <div *ngIf="isAnalyzing" class="loading-state">
                    <div class="spinner"></div>
                    <p>AI is scanning for anomalies...</p>
                </div>

                <div *ngIf="analysisComplete" class="results-state">
                    <div class="summary-box">
                        <span class="label">Detection Confidence</span>
                        <div class="progress-bar">
                            <div class="fill" style="width: 92%"></div>
                        </div>
                        <span class="value">92%</span>
                    </div>

                    <h4>Detected Anomalies</h4>
                    <ul class="findings-list">
                        <li *ngFor="let item of results" [class]="item.severity.toLowerCase()">
                            <div class="finding-header">
                                <span class="region">{{ item.region }}</span>
                                <span class="tag">{{ item.severity }} priority</span>
                            </div>
                            <p>{{ item.description }}</p>
                        </li>
                    </ul>

                    <div class="recommendations">
                        <h4><i class="fa-solid fa-user-doctor"></i> Recommendation</h4>
                        <p>Schedule a follow-up consultation for detailed neuropsychological assessment.</p>
                    </div>

                    <button class="btn-outline">
                        <i class="fa-solid fa-file-pdf"></i> Download Report
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>