<div class="followup-container">
    <div class="header-section">
        <h1>Medical Follow-up & Treatment</h1>
        <div class="tabs">
            <button [class.active]="activeTab === 'prescriptions'" (click)="activeTab = 'prescriptions'">
                <i class="fa-solid fa-pills"></i> Prescriptions
            </button>
            <button [class.active]="activeTab === 'update'" (click)="activeTab = 'update'">
                <i class="fa-solid fa-pen-to-square"></i> Update Record
            </button>
        </div>
    </div>

    <!-- Prescriptions Tab -->
    <div *ngIf="activeTab === 'prescriptions'" class="tab-content">
        <div class="card">
            <div class="card-header">
                <h3>Current Medications</h3>
                <button class="btn-primary-sm"><i class="fa-solid fa-plus"></i> Add New</button>
            </div>
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th>Medication</th>
                            <th>Dosage</th>
                            <th>Frequency</th>
                            <th>Start Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let p of prescriptions" [class.inactive]="p.status === 'Discontinued'">
                            <td class="med-name">
                                <i class="fa-solid fa-prescription-bottle-medical"></i>
                                {{ p.medication }}
                            </td>
                            <td>{{ p.dosage }}</td>
                            <td>{{ p.frequency }}</td>
                            <td>{{ p.startDate }}</td>
                            <td>
                                <span class="status-badge" [class.active]="p.status === 'Active'">
                                    {{ p.status }}
                                </span>
                            </td>
                            <td>
                                <button class="btn-icon" (click)="toggleStatus(p.id)" title="Toggle Status">
                                    <i class="fa-solid" [class.fa-ban]="p.status === 'Active'"
                                        [class.fa-check]="p.status === 'Discontinued'"></i>
                                </button>
                                <button class="btn-icon delete" title="Remove"><i
                                        class="fa-solid fa-trash"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Update Record Tab -->
    <div *ngIf="activeTab === 'update'" class="tab-content">
        <div class="card form-card">
            <div class="card-header">
                <h3>Update Medical Record</h3>
            </div>
            <form (ngSubmit)="submitUpdate()">
                <div class="form-row">
                    <div class="form-group">
                        <label>Date</label>
                        <input type="date" [(ngModel)]="newUpdate.date" name="date" required>
                    </div>
                    <div class="form-group">
                        <label>Type of Update</label>
                        <select [(ngModel)]="newUpdate.type" name="type">
                            <option>Routine Check</option>
                            <option>Emergency Visit</option>
                            <option>Treatment Adjustment</option>
                            <option>Lab Results</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Blood Pressure (mmHg)</label>
                        <input type="text" [(ngModel)]="newUpdate.vitals.bp" name="bp" placeholder="e.g. 120/80">
                    </div>
                    <div class="form-group">
                        <label>Weight (kg)</label>
                        <input type="number" [(ngModel)]="newUpdate.vitals.weight" name="weight">
                    </div>
                </div>

                <div class="form-group">
                    <label>Clinical Notes / Observations</label>
                    <textarea rows="5" [(ngModel)]="newUpdate.notes" name="notes"
                        placeholder="Enter detailed observations, patient complaints, or changes in condition..."></textarea>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-secondary">Cancel</button>
                    <button type="submit" class="btn-primary">Save Update</button>
                </div>
            </form>
        </div>
    </div>
</div>